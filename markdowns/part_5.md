# GO/KO annotation and enrichment analyses


*environiment:* yaml.enrichment


*aim:* gain functional insight on the genes associated to crema - vicia interactions.


---


GO annotation has been carried out using [PANNZER](http://ekhidna2.biocenter.helsinki.fi/sanspanz/)
using no filtering and defeault parameters. 
PANNZER assigned 39826 and 99954 GO-terms respectively to crema and vicia (7526 and 18794 transcripts).


Subsequent enrichment analysis legerage [topGO](https://bioconductor.org/packages/release/bioc/html/topGO.html)
and for this purpose the PANNZER output needs to be reformatted using:


```
sh scripts/reformat_GOs.sh enrichment/GO_crema/GO_crema_predictions.lst enrichment/GO_crema/GO_crema_geneUniverse
```


and


```
sh scripts/reformat_GOs.sh enrichment/GO_vicia/GO_vicia_predictions.lst enrichment/GO_vicia/GO_vicia_geneUniverse
```


The the GO enrichment analysisis is performed using the following commands:


```
Rscript scripts/GO_enrichment.Rscript enrichment/GO_vicia/GO_vicia_geneUniverse 
abundances/vicia/vicia_deseq_gene/ BP 3 weight fisher 0.05 enrichment/GO_vicia/
```


and


```
Rscript scripts/GO_enrichment.Rscript enrichment/GO_crema/GO_crema_geneUniverse 
abundances/vicia/crema_deseq_gene/ BP 3 weight fisher 0.05 enrichment/GO_crema/
```


The Rscript has several positional arguments:


1. the gene universe
2. the input folder containing the genes subsets considered
3. the onyology considered (BP/MF/CC)
4. the minimum node size
5. the algorythm
6. the statistical test
7. the p value cutoff


For this project, a hierachy-aware algoryhm (weight) was used to find enriched BP terms 
and nodes are required to have at least 3 genes associated to be 
included. Terms are considered to be enriched only if p < 0.05
in Fisher's Exact Test.


Raw GSEA output are available in:


```enrichment/GO_vicia/vicia_DN_BP_enrichment.tsv```
```enrichment/GO_vicia/vicia_DN_UP_enrichment.tsv```


GO enrichment analyses were further charchteryzed with [rrvgo](http://www.bioconductor.org/packages/release/bioc/vignettes/rrvgo/inst/doc/rrvgo.html), 
using the Rscript ```plot_GO_enrichment.Rscript```


NB: this part has been carried out from any environiment due to conflicts. 
Relevant libraries are reported inside the script and dbs can be installed 
in R using ```BiocManager::install("org.At.tair.db")``` and ```BiocManager::install("org.Dm.eg.db")```.



The Rscript positional arguments:


1. enriched goterms alog with their p value /  ```red_enrichment.tsv``` files generated by ```GO_enrichment.Rscript```
2. similarity calculation method
3. the onyology considered (BP/MF/CC)
4. treshold for finding high ranking GO terms
5. the database
6. color
7. output files


in brief:


- p values are -log10 transformed and used as scores
- calculateSimMatrix function is used to calculate score similarities between GO terms, using Rel method and org.At.tair.db db
- reduceSimMatrix is used to identify high ranking GO terms based on their semantic similarity and scores, using a treshold of 8


For vicia:


```
Rscript scripts/enrichment_vicia_def2.R enrichment/GO_vicia/vicia_UP_BP_red_enrichment.tsv 
Rel BP 0.8 org.At.tair.db orange images/vicia_UP.jpg
```
```
Rscript scripts/enrichment_vicia_def2.R enrichment/GO_vicia/vicia_DN_BP_red_enrichment.tsv 
Rel BP 0.8 org.At.tair.db lightblue images/vicia_DN.jpg
```

Here are the results for vicia (upreg in orange dnreg in blue):


![Image description](https://github.com/for-giobbe/PAINT/blob/main/images/vicia_UP.jpg)
![Image description](https://github.com/for-giobbe/PAINT/blob/main/images/vicia_DN.jpg)


For crema:


```
Rscript scripts/enrichment_vicia_def2.R enrichment/GO_vicia/vicia_UP_BP_red_enrichment.tsv
Rel BP 0.8 org.At.tair.db orange images/vicia_UP.jpg
```
```
Rscript scripts/enrichment_vicia_def2.R enrichment/GO_vicia/vicia_DN_BP_red_enrichment.tsv
Rel BP 0.8 org.At.tair.db lightblue images/vicia_DN.jpg
```
```
Rscript scripts/enrichment_vicia_def2.R enrichment/GO_vicia/vicia_UP_BP_red_enrichment.tsv
Rel BP 0.8 org.At.tair.db orange images/vicia_UP.jpg
```
```
Rscript scripts/enrichment_vicia_def2.R enrichment/GO_vicia/vicia_DN_BP_red_enrichment.tsv
Rel BP 0.8 org.At.tair.db lightblue images/vicia_DN.jpg

Here are the results for crema (upreg in orange dnreg in blue):

![Image description](https://github.com/for-giobbe/PAINT/blob/main/images/vicia_UP.jpg)
![Image description](https://github.com/for-giobbe/PAINT/blob/main/images/vicia_DN.jpg)

---


KO annotation has been carried out using [BlastKOALA](https://www.kegg.jp/blastkoala/)
leveraging the correct Taxonomy ID and the family_eukaryotes database.
BlastKOALA assigned XXX and YYY KO-terms respectively to crema and vicia.


Subsequent enrichment analysis legeraged [KEGGREST](https://www.bioconductor.org/packages/release/bioc/html/KEGGREST.html)


---


[prev](https://github.com/for-giobbe/PAINT/blob/main/markdowns/part_4.md) / [main](https://github.com/for-giobbe/PAINT) / [next](https://github.com/for-giobbe/PAINT/blob/main/markdowns/part_6.md)

